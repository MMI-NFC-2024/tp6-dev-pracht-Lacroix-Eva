---
import Layout from "../../../layouts/Layout.astro";
import penguins from "../../../assets/penguins.json";

export async function getStaticPaths() {
    // Extraire toutes les espèces uniques du fichier JSON
    const speciesList = [...new Set(penguins.map((p) => p.species))];
    return speciesList.map((species) => ({
        params: { species }
    }));
}

import PlotFigure from "../../../components/PlotFigure.astro";
import * as Plot from "@observablehq/plot";

const { species } = Astro.params;

// Filtrer les pingouins pour l'espèce spécifiée
const filteredPenguins = penguins.filter((s) => s.species === species);

// Configuration du graphique
const plotOptions = {
    grid: true,
    marks: [
        Plot.dot(
            filteredPenguins,
            {
                x: "culmen_length_mm",
                y: "culmen_depth_mm",
                stroke: "species",
            }
        ),
    ],
}
---
<Layout>
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8 mt-8">
        <h1 class="text-3xl font-bold text-center text-purple-600 mb-6">
            Penguins – Rendu dynamique
        </h1>
        <h2 class="text-xl font-semibold text-gray-700 mb-2 text-center">
            Pingouins de l'espèce <span class="text-purple-500">{species}</span>
        </h2>
        <p class="text-center text-gray-600 mb-6">
            {filteredPenguins.length} pingouin(s) trouvé(s) pour l'espèce <span class="font-medium">{species}</span>
        </p>
        <div class="flex justify-center">
            <PlotFigure options={plotOptions} />
        </div>
    </div>
</Layout>
